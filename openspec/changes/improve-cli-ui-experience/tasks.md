# Implementation Tasks

## 1. プログレス表示機能の実装

- [ ] 1.1 プログレスコンテキストマネージャーの作成
  - [ ] 1.1.1 Rich Progressラッパーの実装
  - [ ] 1.1.2 複数タスクの進捗管理
  - [ ] 1.1.3 スピナー表示の統合

- [ ] 1.2 長時間処理へのプログレス追加
  - [ ] 1.2.1 Neo4j保存処理の進捗表示
  - [ ] 1.2.2 ファイル読み込み処理の進捗表示
  - [ ] 1.2.3 PDF生成処理の進捗表示
  - [ ] 1.2.4 CSV解析処理の進捗表示

## 2. インタラクティブプロンプトの改善

- [ ] 2.1 入力プロンプトラッパーの作成
  - [ ] 2.1.1 必須・オプション項目の区別表示
  - [ ] 2.1.2 デフォルト値の提示機能
  - [ ] 2.1.3 リアルタイムバリデーション
  - [ ] 2.1.4 入力例の表示機能
  - [ ] 2.1.5 **ペンディング（保留）マーク機能** - 「未確定」として保留可能

- [ ] 2.2 確認・修正画面の実装
  - [ ] 2.2.1 入力内容のサマリー表示（保留項目は黄色で表示）
  - [ ] 2.2.2 項目選択による修正機能
  - [ ] 2.2.3 全項目の再入力機能
  - [ ] 2.2.4 **保留項目の一覧表示と更新プロンプト**

- [ ] 2.3 対話型デモの改善
  - [ ] 2.3.1 `examples/demo_interactive.py`の改修
  - [ ] 2.3.2 スキップ機能の追加
  - [ ] 2.3.3 ショートカットヘルプの表示
  - [ ] 2.3.4 **保留機能のデモンストレーション**

## 3. 結果表示の強化

- [ ] 3.1 家系図のASCIIアート表示
  - [ ] 3.1.1 テキストベース家系図ジェネレーターの実装
  - [ ] 3.1.2 相続人の関係性の視覚化
  - [ ] 3.1.3 カラーコーディング（相続順位別）

- [ ] 3.2 相続割合の視覚化
  - [ ] 3.2.1 プログレスバー形式の割合表示
  - [ ] 3.2.2 パイチャート風の文字表現
  - [ ] 3.2.3 相続人比較の視覚化

- [ ] 3.3 サマリー表示の改善
  - [ ] 3.3.1 重要情報の強調表示（Panel使用）
  - [ ] 3.3.2 警告・注意事項の目立つ表示
  - [ ] 3.3.3 計算根拠の分かりやすい表示

## 4. エラーメッセージとヘルプの改善

- [ ] 4.1 エラーメッセージの改善
  - [ ] 4.1.1 具体的な修正方法の提示
  - [ ] 4.1.2 入力例の表示
  - [ ] 4.1.3 関連ドキュメントへのリンク

- [ ] 4.2 コマンドヘルプの拡充
  - [ ] 4.2.1 各コマンドの使用例の追加
  - [ ] 4.2.2 よくある使い方のガイド
  - [ ] 4.2.3 ショートカット一覧の表示

- [ ] 4.3 インラインヘルプの追加
  - [ ] 4.3.1 入力中の`?`コマンドでヘルプ表示
  - [ ] 4.3.2 各フィールドの説明文の追加
  - [ ] 4.3.3 操作可能なコマンド一覧の表示

## 5. セッション管理機能の実装

- [ ] 5.1 セッションストレージの実装
  - [ ] 5.1.1 一時ファイルへの保存機能
  - [ ] 5.1.2 セッションIDの生成と管理
  - [ ] 5.1.3 セッションデータの暗号化（オプション）
  - [ ] 5.1.4 **保留項目の状態管理** - pending_items フィールドの追加

- [ ] 5.2 中断・再開機能
  - [ ] 5.2.1 Ctrl+Cでの安全な中断処理
  - [ ] 5.2.2 セッション一覧の表示（保留項目数も表示）
  - [ ] 5.2.3 セッション再開コマンドの実装
  - [ ] 5.2.4 **再開時の保留項目更新プロンプト**

- [ ] 5.3 履歴管理機能
  - [ ] 5.3.1 過去の計算履歴の保存
  - [ ] 5.3.2 履歴からの再実行機能
  - [ ] 5.3.3 履歴の検索・フィルタリング
  - [ ] 5.3.4 **保留項目を含む履歴の管理**

## 6. データモデルの拡張

- [ ] 6.1 Person モデルへの連絡先フィールド追加
  - [ ] 6.1.1 `src/models/person.py` にaddress, phone, emailフィールド追加
  - [ ] 6.1.2 Pydantic バリデーションの追加（email形式、電話番号形式）
  - [ ] 6.1.3 既存データとの互換性テスト

- [ ] 6.2 Neo4j スキーマ拡張
  - [ ] 6.2.1 Person ノードへのプロパティ追加
  - [ ] 6.2.2 リポジトリ層での連絡先情報の保存・読み込み
  - [ ] 6.2.3 マイグレーションスクリプト（必要に応じて）

- [ ] 6.3 連絡先情報入力機能の実装
  - [ ] 6.3.1 相続人確定後の連絡先入力プロンプト
  - [ ] 6.3.2 連絡先情報の検証（住所、電話番号、メール）
  - [ ] 6.3.3 連絡先情報のスキップ機能

- [ ] 6.4 レポート出力への連絡先情報反映
  - [ ] 6.4.1 PDF レポートへの連絡先情報の追加
  - [ ] 6.4.2 Markdown レポートへの連絡先情報の追加
  - [ ] 6.4.3 JSON 出力への連絡先情報の追加

## 7. テストの追加

- [ ] 7.1 表示機能のテスト
  - [ ] 7.1.1 プログレス表示のテスト
  - [ ] 7.1.2 ASCIIアート家系図のテスト
  - [ ] 7.1.3 視覚化機能のテスト

- [ ] 7.2 インタラクティブ機能のテスト
  - [ ] 7.2.1 プロンプト入力のモックテスト
  - [ ] 7.2.2 確認画面のテスト
  - [ ] 7.2.3 セッション管理のテスト
  - [ ] 7.2.4 **保留機能のテスト**
  - [ ] 7.2.5 **連絡先入力のテスト**

- [ ] 7.3 データモデルのテスト
  - [ ] 7.3.1 連絡先フィールドのバリデーションテスト
  - [ ] 7.3.2 Person モデルの後方互換性テスト
  - [ ] 7.3.3 Neo4j連絡先情報保存・読み込みテスト

## 8. ドキュメントの更新

- [ ] 8.1 ユーザーガイドの更新
  - [ ] 8.1.1 新機能の使い方の説明
  - [ ] 8.1.2 スクリーンショット・GIFの追加
  - [ ] 8.1.3 FAQ の追加
  - [ ] 8.1.4 **保留機能の使い方ガイド**
  - [ ] 8.1.5 **連絡先情報入力ガイド**

- [ ] 8.2 開発者ドキュメントの更新
  - [ ] 8.2.1 表示機能の設計ドキュメント
  - [ ] 8.2.2 セッション管理の仕様書
  - [ ] 8.2.3 コード例の追加
  - [ ] 8.2.4 **保留項目管理の設計ドキュメント**
  - [ ] 8.2.5 **Person モデル拡張の設計書**

## Dependencies

- **2.3 depends on 2.1, 2.2**: インタラクティブデモは入力プロンプトと確認画面の実装後に改修
- **3.3 depends on 3.1, 3.2**: サマリー表示は他の視覚化機能完成後に統合
- **6.3 depends on 6.1**: 連絡先入力機能はPersonモデル拡張後に実装
- **6.4 depends on 6.1, 6.2**: レポート出力はモデルとDB拡張後に実装
- **7.1, 7.2, 7.3 depend on 1-6**: 全実装完了後にテスト追加

## Parallelizable Work

- **Group A** (並列実行可能):
  - 1.1 プログレスコンテキストマネージャー
  - 2.1 入力プロンプトラッパー
  - 3.1 ASCIIアート家系図
  - 6.1 Person モデル拡張

- **Group B** (並列実行可能):
  - 1.2 長時間処理へのプログレス追加
  - 2.2 確認・修正画面
  - 3.2 相続割合の視覚化
  - 6.2 Neo4j スキーマ拡張

- **Group C** (並列実行可能):
  - 4.1 エラーメッセージ改善
  - 4.2 コマンドヘルプ拡充
  - 5.1 セッションストレージ

- **Group D** (並列実行可能、Group A完了後):
  - 6.3 連絡先情報入力機能
  - 6.4 レポート出力への連絡先情報反映
